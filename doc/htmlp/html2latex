#!/bin/sh
# $Id: html2latex,v 1.10 2007/07/15 02:56:38 deraugla Exp $

FILES="index.html ptools.html parsers.html fparsers.html lexers.html grammars.html pretty.html opretty.html ml_ast.html pragma.html extfun.html"

echo "\
\\\\documentclass{report}
\\\\addtolength{\\\\oddsidemargin}{-2.2cm}
\\\\addtolength{\\\\evensidemargin}{-2.2cm}
\\\\addtolength{\\\\textwidth}{4.4cm}
\\\\addtolength{\\\\topmargin}{-2.2cm}
\\\\addtolength{\\\\textheight}{4.4cm}
\\\\begin{document}

\\\\def\\\\cslversion{4.04}

\\\\thispagestyle{empty}
\\\\begin{center}
~\\\\vfill
\\\\Huge           Camlp5 - Reference Manual \\\\\\\\
\\\\Large          version \\\\cslversion \\\\\\\\[1cm]
\\\\large          Daniel de Rauglaudre \\\\\\\\
                \\\\today \\\\\\\\[1cm]
\\\\vfill
\\\\normalsize	Copyright \\\\copyright\\\\ 2007 Institut National de
                Recherche en Informatique et Automatique

This document was generated from the html documentation pages by an
internal shell script.
\\\\end{center} \\\\setcounter{page}{1} \\\\cleardoublepage

\\\\tableofcontents
\\\\cleardoublepage"

for i in $FILES; do
  echo "======" 1>&2
  echo "$i" 1>&2
  cat $i |
  sed \
    -e '{:b; /<\/p>$/N; s|<\/p>\n *|<\/p>|g; tb}' \
    -e 's|</p><p>|\n\n\\ \n\n\\noindent |g' \
    -e '{s/^ *<p>/\\noindent /; s|</p>|\n\n|}' |
  sed \
    -e '0,/<div id="content">/d' \
    -e 's/^ *<h1[^>]*>/\\chapter{/' -e 's|</h1>|}|' \
    -e 's/^ *<h2>/\\section{/' -e 's|</h2>|}|' \
    -e 's/^ *<h3>/\\subsection{/' -e 's|</h3>|}|' \
    -e 's/^ *<h4>/\\subsubsection{/' -e 's|</h4>|}|' \
    -e 's/^ *<ul>/\\begin{itemize}/' -e 's|^ *</ul>|\\end{itemize}|' \
    -e 's/^ *<ol>/\\begin{enumerate}/' -e 's|^ *</ol>|\\end{enumerate}|' \
    -e 's/^ *<li>/\\item /' -e 's| *</li>||' \
    -e '/<pre>/,/<\/pre>/s/^/  /g' \
    -e 's/^ *<pre>/\\begin{verbatim}/' -e 's|^ *</pre>|\\end{verbatim}|' \
    -e 's/<code>/\\texttt{/g' -e 's|</code>|}|g' \
    -e 's/<tt>/\\texttt{/g' -e 's|</tt>|}|g' \
    -e 's/<em>/\\emph{/g' -e 's|</em>|}|g' \
    -e 's/<i>/\\emph{/g' -e 's|</i>|}|g' \
    -e 's/<b>/\\textbf{/g' -e 's|</b>|}|g' \
    -e 's/<a [^>]*>//g' -e 's|</a>||g' \
    -e 's/<span [^>]*>//g' -e 's|</span>||g' \
    -e 's/&lt;/</g' -e 's/&gt;/>/g' \
    -e 's/_/\\_/g' \
    -e 's/#/\\#/g' \
    -e 's/\$/\\$/g' \
    -e '/\\begin{verbatim}/,/\\end{verbatim}/s/\\_/_/g' \
    -e '/\\begin{verbatim}/,/\\end{verbatim}/s/\\#/#/g' \
    -e '/\\begin{verbatim}/,/\\end{verbatim}/s/\\\$/$/g' \
    -e '/<div class="trailer">/,$d'
done

echo "
\\\\end{document}"
