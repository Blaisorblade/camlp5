<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" 
 "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
<head>
  <!-- $Id: grammars.html,v 1.4 2007/07/14 19:05:00 deraugla Exp $ -->
  <!-- Copyright (c) 2007 INRIA -->
  <title>extensible grammars</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <link rel="shortcut icon" href="c4logo.png" />
  <link rel="stylesheet" type="text/css" href="styles/base.css" />
</head>
<body>

<div id="menu">
</div>

<div id="content">

<h1 class="top">Extensible grammars</h1>

<h2>Introduction</h2>

<p>The extensible grammars are a system to build <em>grammar
entries</em> which can be extended dynamically. A grammar entry is an
abstract value internally containing a stream parser. The type of a
grammar entry is <tt>"Grammar.Entry.e t"</tt> where <tt>"t"</tt> is
the type of the values returned by the grammar entry.</p>

<p>To start with extensible grammars, it is necessary to build
a <em>grammar</em>, a value of type "<tt>Grammar.g</tt>", using
the function "<tt>Grammar.gcreate</tt>":</p>

<pre>
value g = Grammar.gcreate lexer;
</pre>

<p>where "<tt>lexer</tt>" is a lexer previously defined. See the
chapter explaining how make lexers for extensible grammars. In a first
time, it is possible to use a lexer provided by camlp5 in the module
"<tt>Plexer</tt>":</p>

<pre>
value g = Grammar.gcreate (Plexer.gmake ());
</pre>

<p>Each grammar entry is associated with a grammar. Only grammar
entries of the same grammar can call each other. To create a grammar
entry, one has to use the function "<tt>Grammar.Entry.create</tt>" with
takes the grammar as first parameter and a name as second parameter. This
name is used in case of syntax errors. For example:</p>

<pre>
value ex = Grammar.Entry.create g "expression";
</pre>

<p>To apply a grammar entry, the function
"<tt>Grammar.Entry.parse</tt>" can be used. Its first parameter is the
grammar entry, the second one a stream of characters:</p>

<pre>
Grammar.Entry.parse ex (Stream.of_string "hello");
</pre>

<p>But if you experiment this, since the entry was just created
without any rules, you receive an error message:</p>

<pre>
Stream.Error "entry [expression] is empty"
</pre>

<p>To add grammar rules to the grammar entry, it is necessary
to <em>extend</em> it, using a specific syntactic statement:
"<tt>EXTEND</tt>".</p>

<h2>Syntax of the EXTEND statement</h2>

<p>The "<tt>EXTEND</tt>" statement is added in the expressions of the
ocaml language when the syntax extension kit "<tt>pa_extend.cmo</tt>"
is loaded. Its syntax is:</p>

<pre>
          expression ::= extend
              extend ::= "EXTEND" extend_body "END"
         extend_body ::= efunction_opt global_opt entries
       efunction_opt ::= "FUNCTION" ":" qualid ";"
                       | &lt;nothing&gt;
</pre>

<p>... to be completed ...</p>

<div class="trailer">
</div>

</div>

</body>
</html>
