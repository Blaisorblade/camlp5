<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" 
 "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
<head>
  <!-- $Id: index.html,v 1.5 2007/07/13 02:08:47 deraugla Exp $ -->
  <!-- Copyright (c) 2007 INRIA -->
  <title>Camlp5</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <link rel="shortcut icon" href="c4logo.png" />
  <link rel="stylesheet" type="text/css" href="styles/base.css" />
</head>
<body>

<div id="menu">
</div>

<div id="content">

<h1 class="top">Overview</h1>

<p>Camlp5 is a preprocessor and pretty-printer for ocaml programs.</p>

<p>As a preprocessor, it allows to:</p>

<ul>

  <li>add syntax extensions,</li>
  <li>redefine the whole syntax of the language.</li>

</ul>

<p>As a pretty printer, it allows to:</p>

<ul>

  <li>display programs in a elegant way,</li>
  <li>convert from a syntax to another,</li>
  <li>check the results of syntax extensions.</li>

</ul>

<p>It works as a shell command and can also be used in the ocaml
toplevel.</p>

<p>Camlp5 also provides some parsing and pretty printing tools.</p>

<a id="Usage"></a>
<h2>Usage</h2>

<p>The main shell commands are:</p>

<ul>
  <li><tt>camlp5o</tt> : to treat files written in normal ocaml
  syntax,</li>
  <li><tt>camlp5r</tt> : to treat files written in an original syntax
    named the <em>revised syntax</em>.</li>
</ul>

<p>These commands can be given as parameters of the
option <tt>-pp</tt> of the ocaml compiler. Examples:</p>

<pre>
ocamlc -pp camlp5o foo.ml
ocamlc -pp camlp5r bar.ml
</pre>

<p>This way, the parsing is done by camlp5. In case of syntax errors,
the parsing fails with an error message and the compilation is
aborted. Otherwise, the ocaml compiler continues with the syntax tree
provided by camlp5.</p>

<p>In the toplevel, it is possible to preprocess the input phrases by
loading one of the files "<tt>camlp5o.cma</tt>" or
"<tt>camlp5r.cma</tt>".  The common usage is:</p>

<pre>
ocaml -I +camlp5 camlp5o.cma
ocaml -I +camlp5 camlp5r.cma
</pre>

<a id="ExtSynt"></a>
<h2>Extending syntax</h2>

<p>A syntax extension is an ocaml object file, i.e. a file with the
extension "<tt>.cmo</tt>". It is a result of the compilation of an
ocaml source file containing what is necessary to do the syntax
extensions. These object files are named <em>parsing kits</em>.</p>

<p>There are two ways to use a syntax extension:<p>

<ul>

  <li>Either by giving this object file as parameter to the camlp5
    command. For example:

<pre>
ocamlc -pp "camlp5o ./myext.cmo" foo.ml
</pre>

  </li>

  <li>Or by adding the directive "<tt>#load</tt>" in the source file:

<pre>
#load "./myext.cmo";;
</pre>

    <p>and compile it simply like this:</p>

<pre>
ocamlc -pp camlp5o foo.ml
</pre>

  </li>

</ul>

<p>Several syntax extensions can be used for a single file. The way to
create one's own syntax extensions is explained further.</p>

<a id="PrettPr"></a>
<h2>Pretty printing</h2>

<p>Like for syntax extensions, <em>pretty printing kits</em> are ocaml
object files. The main pretty printing kits provided by camlp5 are:</p>

<ul>

<li><tt>pr_o.cmo</tt>: to pretty print in normal syntax,</li>
<li><tt>pr_r.cmo</tt>: to pretty print in revised syntax.</li>

</ul>

<p>Examples: if we have a file, <tt>foo.ml</tt>, written in normal
syntax and and another one, <tt>bar.ml</tt>, written in revised
syntax, here are the commands to pretty print them in their own
syntax:</p>

<pre>
camlp5o pr_o.cmo foo.ml
camlp5r pr_r.cmo bar.ml
</pre>

<p>And how to convert them into the other syntax:</p>

<pre>
camlp5o pr_r.cmo foo.ml
camlp5r pr_o.cmo foo.ml
</pre>

<p>The way to create one's own pretty printing extensions is
explained further.</p>

<div class="trailer">

  <hr style="margin:0" /><div style="font-size: 80%"><em>Copyright 2007
      Daniel de Rauglaudre (INRIA)</em></div>

  <p class="bottom">
    <a href="http://validator.w3.org/check?uri=referer"><img
       src="http://www.w3.org/Icons/valid-xhtml11" style="border:0"
       alt="Valid XHTML 1.1" height="31" width="88" /></a>
  </p>

</div>

</div>

</body>
</html>
